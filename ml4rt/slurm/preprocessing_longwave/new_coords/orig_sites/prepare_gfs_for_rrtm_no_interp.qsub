#!/bin/tcsh

#SBATCH --job-name="prepare_gfs_for_rrtm_no_interp"
#SBATCH --partition="fge"
#SBATCH --account="rda-ghpcs"
#SBATCH --qos="batch"
#SBATCH --ntasks=1
#SBATCH --nodes=1
#SBATCH --cpus-per-task=1
##SBATCH --nodes=1
##SBATCH --ntasks=1
##SBATCH --cpus-per-task=1
##SBATCH --ntasks-per-node=1
#SBATCH --time=12:00:00
#SBATCH --array=1-171
#SBATCH --exclude=h28n12
##SBATCH --exclude=h31n03,h28n12
##SBATCH --exclude=h29n01,h26n05,h28n06,h29n07,h30n03,h30n15
#SBATCH --mail-type=BEGIN,END,FAIL
#SBATCH --mail-user=ryan.lagerquist@noaa.gov
#SBATCH --output=prepare_gfs_for_rrtm_no_interp_%A_%a.out

module load cuda/10.1
source /scratch2/BMC/gsd-hpcs/Jebb.Q.Stewart/conda3.7/etc/profile.d/conda.csh
conda activate base

set CODE_DIR_NAME="/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4rt_standalone/ml4rt"
set INPUT_DIR_NAME="/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4rt_project/gfs_data"
set OUTPUT_DIR_NAME="${INPUT_DIR_NAME}/processed/orig_heights"

set INPUT_DATE_STRINGS=("20191201" "20191202" "20191203" "20191204" "20191205" "20191206" "20191207" "20191208" "20191209" "20191210" "20191211" "20191212" "20191213" "20191214" "20191215" "20191216" "20191217" "20191218" "20191219" "20191220" "20191221" "20191222" "20191223" "20191224" "20191225" "20191226" "20191227" "20191228" "20191229" "20191230" "20191231" "20200101" "20200102" "20200103" "20200104" "20200105" "20200106" "20200107" "20200108" "20200109" "20200110" "20200111" "20200112" "20200113" "20200114" "20200115" "20200116" "20200117" "20200118" "20200119" "20200120" "20200121" "20200122" "20200123" "20200124" "20200125" "20200126" "20200127" "20200128" "20200129" "20200130" "20200131" "20200201" "20200202" "20200203" "20200204" "20200205" "20200206" "20200207" "20200208" "20200209" "20200210" "20200211" "20200212" "20200213" "20200214" "20200215" "20200216" "20200217" "20200218" "20200219" "20200220" "20200221" "20200222" "20200223" "20200224" "20200225" "20200226" "20200227" "20200228" "20200229" "20200301" "20200302" "20200303" "20200304" "20200305" "20200306" "20200307" "20200308" "20200309" "20200310" "20200311" "20200312" "20200313" "20200314" "20200315" "20200316" "20200317" "20200318" "20200319" "20200320" "20200321" "20200322" "20200323" "20200324" "20200325" "20200326" "20200327" "20200328" "20200329" "20200330" "20200331" "20200401" "20200402" "20200403" "20200404" "20200405" "20200406" "20200407" "20200408" "20200409" "20200410" "20200411" "20200412" "20200413" "20200414" "20200415" "20200416" "20200417" "20200418" "20200419" "20200420" "20200421" "20200422" "20200423" "20200424" "20200425" "20200426" "20200427" "20200428" "20200429" "20200430" "20200501" "20200502" "20200503" "20200504" "20200505" "20200506" "20200507" "20200508" "20200509" "20200510" "20200511" "20200512" "20200513" "20200514" "20200515" "20200516" "20200517" "20200518" "20200519")
set OUTPUT_DATE_STRINGS=("2019335" "2019336" "2019337" "2019338" "2019339" "2019340" "2019341" "2019342" "2019343" "2019344" "2019345" "2019346" "2019347" "2019348" "2019349" "2019350" "2019351" "2019352" "2019353" "2019354" "2019355" "2019356" "2019357" "2019358" "2019359" "2019360" "2019361" "2019362" "2019363" "2019364" "2019365" "2020001" "2020002" "2020003" "2020004" "2020005" "2020006" "2020007" "2020008" "2020009" "2020010" "2020011" "2020012" "2020013" "2020014" "2020015" "2020016" "2020017" "2020018" "2020019" "2020020" "2020021" "2020022" "2020023" "2020024" "2020025" "2020026" "2020027" "2020028" "2020029" "2020030" "2020031" "2020032" "2020033" "2020034" "2020035" "2020036" "2020037" "2020038" "2020039" "2020040" "2020041" "2020042" "2020043" "2020044" "2020045" "2020046" "2020047" "2020048" "2020049" "2020050" "2020051" "2020052" "2020053" "2020054" "2020055" "2020056" "2020057" "2020058" "2020059" "2020060" "2020061" "2020062" "2020063" "2020064" "2020065" "2020066" "2020067" "2020068" "2020069" "2020070" "2020071" "2020072" "2020073" "2020074" "2020075" "2020076" "2020077" "2020078" "2020079" "2020080" "2020081" "2020082" "2020083" "2020084" "2020085" "2020086" "2020087" "2020088" "2020089" "2020090" "2020091" "2020092" "2020093" "2020094" "2020095" "2020096" "2020097" "2020098" "2020099" "2020100" "2020101" "2020102" "2020103" "2020104" "2020105" "2020106" "2020107" "2020108" "2020109" "2020110" "2020111" "2020112" "2020113" "2020114" "2020115" "2020116" "2020117" "2020118" "2020119" "2020120" "2020121" "2020122" "2020123" "2020124" "2020125" "2020126" "2020127" "2020128" "2020129" "2020130" "2020131" "2020132" "2020133" "2020134" "2020135" "2020136" "2020137" "2020138" "2020139" "2020140")
set input_date_string=${INPUT_DATE_STRINGS[$SLURM_ARRAY_TASK_ID]}
set output_date_string=${OUTPUT_DATE_STRINGS[$SLURM_ARRAY_TASK_ID]}

set input_file_name="${INPUT_DIR_NAME}/gfs_${input_date_string}.nc"
set output_file_name="${OUTPUT_DIR_NAME}/profiler_sitesF.ncep_rap.${output_date_string}.0000.nc"

python3 -u "${CODE_DIR_NAME}/prepare_gfs_for_rrtm_no_interp.py" \
--input_file_name="${input_file_name}" \
--output_file_name="${output_file_name}"
